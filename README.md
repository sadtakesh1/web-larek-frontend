# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
# Документация


## Об архитектуре 

``Взаимодействие частей``:

Данные взаимодействуют с отображениями через события. Модели изменяют свое состояние и вызывают события, на которые подписаны компоненты.
Отображения обновляют свой контент на основе данных, предоставленных моделями, и инициируют действия пользователя, такие как добавление товара в корзину или оформление заказа.
Экраны объединяют отображения, предоставляя целостный интерфейс для взаимодействия пользователя с приложением.

``Используемые данные``:

IProduct: Представляет продукт в каталоге, включает идентификатор, описание, URL изображения, название, категорию, цену и флаг выбора.

ICardActions: Определяет действия с карточкой товара, такие как нажатие.

IProductModel: Методы для управления продуктами: установка каталога, предпросмотр продукта, добавление и удаление из корзины, переключение состояния, проверка наличия в корзине, получение счетчика и списка продуктов корзины, вычисление общей стоимости, очистка корзины, установка полей заказа и проверка валидности.

IOrder: Представляет заказ, включает способ оплаты, электронную почту, телефон, адрес доставки, общую стоимость и список идентификаторов продуктов.

IOrderForm: Форма для сбора данных клиента, включает способ оплаты, адрес доставки, электронную почту и телефон.

IOrderResult: Результат отправки заказа, включает идентификатор заказа и общую стоимость.

IBasketView: Отображение корзины, включает массив элементов, общую стоимость и список выбранных продуктов.

TBasketCard: Карточка продукта в корзине, включает идентификатор, название и цену.

FormErrors: Ошибки формы заказа, ключи соответствуют полям формы, значения - сообщения об ошибках.

``Компоненты приложения``:

Card: Компонент для отображения информации о продукте.

Basket: Компонент для отображения товаров в корзине и общей стоимости.

Contacts: Форма для ввода контактной информации.

Order: Форма для оформления заказа, включая выбор способа оплаты и адреса доставки.

Page: Компонент, объединяющий другие компоненты для отображения полной страницы.

## Базовый код

### 1. Класс ``Model<T>``
Класс Model представляет собой абстрактный класс, который используется для создания моделей с определёнными данными и возможностью обработки событий. Этот класс помогает организовать и управлять состоянием данных, а также обеспечивает механизм для уведомления о событиях.

### 2. ``Типы и Класс Api``

``ApiListResponse`` Тип для типизации ответов API, возвращающих списки элементов.
```
export type ApiListResponse<Type> = {
    total: number,
    items: Type[]
};
```
``ApiPostMethods`` Тип для методов HTTP-запросов, которые изменяют данные на сервере.
```
export type ApiPostMethods = 'POST' | 'PUT' | 'DELETE';
```
``Класс Api`` Класс для выполнения HTTP-запросов к базовому URL.
```
constructor(baseUrl: string, options: RequestInit = {})
```
``baseUrl``: Базовый URL для запросов API.

``options``: Объект конфигурации запросов RequestInit.

### ``Методы``

``handleResponse`` Обрабатывает ответ от API, возвращая JSON или ошибку.
```
protected handleResponse(response: Response): Promise<object>
```
``get`` Выполняет GET-запрос и возвращает результат в виде JSON.
```
get(uri: string): Promise<object>
```
``post``
```
post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>
```
### ``Выполняет POST, PUT или DELETE-запрос с заданными данными и возвращает результат в виде JSON.``

### 3. ``Класс EventEmitter``

Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий. Конструктор не принимает никаких параметров.

``Основные методы``, реализуемые классом, описаны интерфейсом IEvents:

| ``on`` - подписка на событие

| ``emit`` - инициализация события

| ``trigger`` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие

### 4. ``Класс Component ``

Абстрактный класс для создания базовых компонентов с инструментами для работы с DOM.

``toggleClass`` - переключает класс элемента

``setText`` - устанавливает текстовое содержимое элемента

``setDisabled`` - Устанавливает или снимает атрибут disabled у элемента.

``setClass`` - Добавляет класс к элементу.

``setHidden`` - Скрывает элемент.

``setVisible`` - Отображает элемент.

``setImage`` - Устанавливает изображение и альтернативный текст у элемента.

``render`` - Возвращает корневой элемент после обновления данных.

### 5. ``Класс ProductModel``
Класс ProductModel используется для управления каталогом продуктов, корзиной покупок и заказами. Он обеспечивает методы для добавления, удаления и проверки продуктов в корзине, а также для управления событиями, связанными с этими операциями.

Методы:

``setCatalog`` - Устанавливает каталог продуктов и инициирует событие.

``setPreview`` - Устанавливает продукт для предпросмотра и инициирует событие.

``getItem`` - Возвращает продукт по идентификатору.

``getItems`` - Возвращает все продукты каталога.

``addProductToBasket`` - Добавляет продукт в корзину и инициирует событие.

``removeProductFromBasket`` - Удаляет продукт из корзины и инициирует событие.

``toggleProductState`` - Переключает состояние продукта и инициирует событие.

``isProductInBasket`` - Проверяет, находится ли продукт в корзине.

``getBasketCounter`` - Возвращает количество продуктов в корзине.

``getBasketProducts`` - Возвращает массив продуктов в корзине.

``getTotal`` - Возвращает общую стоимость продуктов в корзине.

``setOrderTotal`` - Устанавливает общую стоимость заказа и инициирует событие.

``clearBasket`` - Очищает корзину и инициирует событие.

``setOrderField`` - Устанавливает поля заказа и инициирует событие.

``validateOrder`` - Проверяет валидность заказа и инициирует событие.

``validateContacts`` - Проверяет валидность контактной информации и инициирует событие.

### 6. ``Класс Card`` 
Класс Card используется для представления и управления карточкой продукта на веб-странице. Он наследует от базового класса Component и предоставляет методы для установки и получения свойств продукта, а также для управления элементами DOM, связанными с карточкой.

### 7. ``Класс Page``
Класс Page используется для управления и взаимодействия с элементами страницы, такими как каталог продуктов, корзина и счетчик товаров в корзине. Он наследует от базового класса Component и предоставляет методы для управления элементами DOM, связанными с этими функциями.

### 8. ``Класс Basket``
Класс Basket используется для управления корзиной товаров на веб-странице. Он наследует от базового класса Component и предоставляет методы для взаимодействия с элементами DOM, связанными с корзиной, а также для управления состоянием корзины.

### 9. ``Класс ApiModel``
Класс AppApi реализует интерфейс IAppApi и предназначен для взаимодействия с API продуктов и заказов. Он наследует от базового класса Api и предоставляет методы для получения списка продуктов, информации о продукте и отправки заказов.

## ``Будущие классы(возможно будут изменены)``

### 10. ``Класс Order``
 Классы Order и Contacts используются для управления формами заказа и контактной информации соответственно. Оба класса наследуют функциональность от абстрактного класса Form<T>, который предоставляет общую реализацию для форм с определённой структурой и методами для работы с ней. Класс Order также предоставляет методы для управления выбором способа оплаты и установки адреса, а класс Contacts предоставляет методы для установки значений полей "phone" и "email".

## ``Типы данных/интерфейсы``

``IProduct``: Представляет продукт в каталоге. Включает идентификатор, описание, URL изображения, название, категорию, цену, и флаг для выбранного состояния.

``ICardActions``: Определяет действия, которые могут быть выполнены с карточкой товара, например, при нажатии на нее.

``IProductModel``: Описывает методы модели для управления продуктами. Включает методы для установки каталога, установки предпросмотра продукта, добавления и удаления продукта из корзины, переключения состояния продукта, проверки наличия продукта в корзине, получения счетчика корзины, получения продуктов корзины, вычисления общей стоимости, установки общей стоимости заказа, очистки корзины, установки полей заказа и проверки валидности заказа и контактной информации.

``IOrder``: Представляет заказ. Включает способ оплаты, электронную почту, телефон, адрес доставки, общую стоимость и список идентификаторов продуктов.

``IOrderForm``: Используется для сбора данных клиента при оформлении заказа. Включает способ оплаты, адрес доставки, электронную почту и телефон.

``IOrderResult``: Представляет результат отправки заказа. Включает идентификатор заказа и общую стоимость.

``IBasketView``: Отображает корзину. Включает массив элементов, общую стоимость и список выбранных продуктов.

``TBasketCard``: Тип, представляющий карточку продукта в корзине. Включает только необходимые поля: идентификатор, название и цену.

``FormErrors``: Тип для ошибок формы заказа. Ключи соответствуют полям формы, значения - сообщения об ошибках.

